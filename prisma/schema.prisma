generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  CANDIDATE
  COMPANY
  ADMIN
}

enum JobStatus {
  OPEN
  CLOSED
}

enum ApplicationStatus {
  APPLIED
  REVIEWING
  INTERVIEWING
  OFFERED
  REJECTED
}

model Users {
  id           String         @id @unique @default(uuid())
  email        String         @unique
  password     String
  role         Role           @default(CANDIDATE)
  isVerified   Boolean        @default(false)
  createdAt    DateTime       @default(now())
  companies    Companies[]
  applications Applications[]
}

model Companies {
  id          String  @id @default(uuid())
  user        Users   @relation(fields: [userId], references: [id])
  userId      String  @unique
  name        String
  website     String
  description String
  isApproved  Boolean @default(false)
  jobs        Jobs[]
}

model Jobs {
  id              String         @id @default(uuid())
  company         Companies      @relation(fields: [companyId], references: [id])
  companyId       String
  companyName     String
  title           String
  description     String
  location        String
  category        String
  salary          Int
  experienceLevel String
  status          JobStatus      @default(OPEN)
  createdAt       DateTime       @default(now())
  applications    Applications[]
}

model Applications {
  id          String            @id @default(uuid())
  job         Jobs              @relation(fields: [jobId], references: [id])
  jobId       String
  candidate   Users             @relation(fields: [candidateId], references: [id])
  candidateId String
  cvUrl       String
  status      ApplicationStatus @default(APPLIED)
  appliedAt   DateTime          @default(now())

  @@unique([jobId, candidateId])
}
